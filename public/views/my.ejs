<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Management</title>
    <link rel="stylesheet" href="/assets/css/teacher.css">
    <link rel="stylesheet" href="/assets/font/fontawesome/icon-font/themify-icons/themify-icons.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/css/bootstrap-select.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/js/bootstrap-select.min.js"></script>
    <script src="/assets/js/teacher.js"></script>

</head>

<body>
    <%- include ("partial/leftsidebar") %>
    <%- include ("partial/dropdown") %>
    <%- include ("partial/chonlop") %>

    <div class="content">

        <!-- phần giữa trang chủ -->
        <div class="main">
            <% if(hoten) { %>
                <h1 class="title-main">Xin chào, <%= hoten %>
                </h1>
                <% } %>

                    <% if(role=='covan' ) { %>
                        <button data-toggle="collapse" data-target="#add-stu" class="btn ml-3">
                            Thêm sinh viên
                        </button>
                        <form id="add-stu" class="adding-member flex-wrap collapse"
                            action="/add/student/<%= email %>/<%= sinhvien[0].malop %>" method="post">
                            <!-- <img src="../assets/img/IMG_8672.png" alt="" class="adding-avt"> -->
                            <div class="adding-id-inf col-md-4">
                                <h2 class="name-inf">MSSV</h2>
                                <input id="stu-id" autocomplete="off" type="text" class="input-inf" name="mssv"
                                    placeholder="mã sv" />
                            </div>
                            <div class="adding-name-inf col-md-4">
                                <h2 class="name-inf">Họ tên</h2>
                                <input id="stu-name" autocomplete="off" type="text" class="input-inf" placeholder="Tên"
                                    name="hoten" />
                            </div>
                            <div class="adding-name-inf col-md-4">
                                <h2 class="name-inf">Ngày sinh</h2>
                                <input id="stu-dob" autocomplete="off" type="date" class="input-inf" name="ngaysinh" />
                            </div>
                            <div class="adding-name-inf col-md-4">
                                <h2 class="name-inf">Lớp khoá học</h2>
                                <input id="stu-class-id" autocomplete="off" type="text" class="input-inf"
                                    placeholder="Mã lớp" name="malop" />
                            </div>
                            <div class="adding-name-inf col-md-4">
                                <h2 class="name-inf">Email</h2>
                                <input id="stu-email" autocomplete="off" type="email" class="input-inf"
                                    placeholder="email" name="email" />
                            </div>
                            <div class="adding-name-inf col-md-4">
                                <h2 class="name-inf">Sđt</h2>
                                <input id="stu-phone" autocomplete="off" type="text" class="input-inf"
                                    placeholder="Số điện thoại" name="sdt" />
                            </div>
                            <input type="submit" value="Thêm sv" id="" class="adding-btn btn ml-3 col-md-2">
                        </form>
                        <% } %>
                            <!-- <div class="member-list">
                                <div class="member">
                                    <img src="/assets/img/IMG_8672.png" alt="" class="member-ava">
                                    <p class="member-name">Name</p>
                                    <p class="member-pos">position</p>
                                </div>
                            </div> -->

                            <!-- xuất excel -->
                            <form action="/download/<%= sinhvien[0].malop %>"
                                class=" row d-flex justify-content-between ml-3 mt-4 mb-3" method="get">
                                <input class="form-control mt-4 col-md-9" id="myInput" type="text"
                                    placeholder="Search..">
                                <input type="submit" class="mt-4 blue-btn btn col-md-2" value="Xuất excel">
                            </form>


                            <!--Bảng danh sách sinh viên-->
                            <div class="table-responsive ml-3">                              
                            <table id="student-table" class=" w-100 table">
                                    <thead>
                                        <tr>
                                            <th>STT</th>
                                            <th>MSSV</th>
                                            <th>Họ và tên</th>
                                            <th>Ngày sinh</th>
                                            <th>Lớp khoá học</th>
                                            <th>Email</th>
                                            <th>SĐT</th>
                                            <% if (role=='covan' ){%>
                                                <th>SĐT phụ huynh</th>
                                                <th>Địa chỉ</th>
                                                <th></th>
                                                <th></th>
                                            <% } %>
                                        </tr>
                                    </thead>
                                    <tbody class="stu-table-body" data-rel="<%= sinhvien.length%>">
                                        <% if(sinhvien) { %>
                                            <% for (var i=0; i < sinhvien.length; i++) { %>
                                                <form id="editstudentinfo"
                                                    action="/editstudentinfo/<%= sinhvien[i].mssv %>/<%= email %>/<%= sinhvien[i].malop %>"
                                                    method="post">
                                                </form>  
                                                <tr>
                                                    <td>
                                                        <%= i+1 %>
                                                    </td>
                                                    <td>
                                                        <%= sinhvien[i].mssv %>
                                                    </td>
                                                    <td>
                                                        <%= sinhvien[i].hoten %>
                                                    </td>
                                                    <td>
                                                        <%= sinhvien[i].ngaysinh %>
                                                    </td>
                                                    <td>
                                                        <%= sinhvien[i].malop %>
                                                    </td>
                                                    <td>
                                                        <%= sinhvien[i].email %>
                                                    </td>
                                                    <td>
                                                        <%= sinhvien[i].sdt %>
                                                    </td>
                                                    <% if(role=='covan' ) { %>
                                                        <td>
                                                            <%= sinhvien[i].sdtphuhuynh %>
                                                        </td>
                                                        <td>
                                                            <%= sinhvien[i].diachi %>
                                                        </td>

                                                        <td>
                                                            <form
                                                                action="/student/delete/<%= sinhvien[i].mssv %>/<%= email %>/<%= sinhvien[i].malop %>"
                                                                method="post">
                                                                <button type="submit" class="delete-btn btn red-btn mt-0" value="Xoá">
                                                                    <i class="ti-trash"></i>
                                                                </button>   
                                                            </form>
                                                        </td>
                                                        <td>
                                                            <!-- Form để chỉnh sửa thông tin sinh viên trong bảng, sau khi
                                                            submit form này thì tạo các input hidden có value = các ô
                                                            trong bảng là được -->
                                                            <div class="stu-btn edit-btn-<%=i+1%> btn yellow-btn mt-0">
                                                                <i class="ti-pencil"></i>
                                                            </div>
                                                            <div value="Lưu lại" class="stu-btn save-btn-<%=i+1%> save-btn btn green-btn mt-0">
                                                                <i class="ti-save"></i>
                                                            </div>
                                                        </td>

                                                        <% } %>
                                                </tr>
                                                <% } %>
                                                    <% } %>
                                    </tbody>
                                </table>
                            </div>
        </div>
    </div>

</body>

</html>